(function(){document.querySelectorAll(".php-email-form").forEach(function(r){r.addEventListener("submit",function(o){o.preventDefault();let e=this,t=e.getAttribute("action"),n=e.getAttribute("data-recaptcha-site-key");if(!t){s(e,"The form action property is not set!");return}e.querySelector(".loading").classList.add("d-block"),e.querySelector(".error-message").classList.remove("d-block"),e.querySelector(".sent-message").classList.remove("d-block");let a=new FormData(e);n?typeof grecaptcha<"u"?grecaptcha.ready(function(){try{grecaptcha.execute(n,{action:"php_email_form_submit"}).then(c=>{a.set("recaptcha-response",c),l(e,t,a)})}catch(c){s(e,c)}}):s(e,"The reCaptcha javascript API url is not loaded!"):l(e,t,a)})});function l(r,o,e){fetch(o,{method:"POST",body:e,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>t.text()).then(t=>{if(r.querySelector(".loading").classList.remove("d-block"),t.trim()=="OK")r.querySelector(".sent-message").classList.add("d-block"),r.reset();else throw new Error(t||"Form submission failed and no error message returned from: "+o)}).catch(t=>{s(r,t)})}function s(r,o){r.querySelector(".loading").classList.remove("d-block"),r.querySelector(".error-message").innerHTML=o,r.querySelector(".error-message").classList.add("d-block")}})();
